SELECT users.name,
billing_group.group_id,
billing_group.spliting_amount,

COUNT(*) AS total_contributor,
(select  COUNT(*) from billing_group_users  WHERE billing_group_users.group_id=billing_group.group_id  AND  billing_group_users.payment_amount IS NOT NULL) AS paid_contributor,

(select  COUNT(*) from billing_group_users  WHERE billing_group_users.group_id=billing_group.group_id  AND  billing_group_users.payment_amount IS  NULL) AS pending_contributor,

(select  COUNT(*) from billing_group_users  WHERE billing_group_users.group_id=billing_group.group_id  AND  billing_group_users.payment_amount IS  NULL) AS pending_contributor, 

(select  billing_group.spliting_amount/COUNT(*)  from `billing_group_users` WHERE billing_group_users.group_id=billing_group.group_id ) AS each_split ,



( SELECT GROUP_CONCAT(users.profile_picture) FROM users LEFT JOIN billing_group_users ON billing_group_users.user_id=users.id WHERE billing_group_users.group_id=billing_group.group_id AND billing_group_users.user_id!=2  ) AS group_users_image,

(select ((billing_group.spliting_amount-sum( case when billing_group_users.payment_amount IS NOT NULL then billing_group_users.payment_amount else 0 end ))/billing_group.spliting_amount) *100  from billing_group_users  WHERE billing_group_users.group_id=billing_group.group_id ) AS percentage



FROM billing_group  

LEFT JOIN billing_group_users ON billing_group_users.group_id=billing_group.group_id  

LEFT JOIN users ON users.id=billing_group_users.group_id     WHERE billing_group_users.group_id=163



SELECT  users.id,CASE WHEN users.profile_picture IS NOT NULL THEN CONCAT('http://3.18.242.37:4000/images/profiles/',users.profile_picture)  ELSE '' END AS profile_picture,users.name,users.id,users_requests.*, (SELECT  COUNT(users_requests.request_for) FROM users_requests WHERE users_requests.is_follow!=0  AND users_requests.request_for=users.id ) AS followed_by 
FROM users 
LEFT JOIN users_requests ON users_requests.request_for=users.id 

WHERE  users.is_group=0 AND users.id <>'2'  

AND ( users_requests.request_for <>'2' OR users_requests.request_for IS NULL ) 
AND ((users_requests.is_accepted=0 OR  users_requests.is_accepted IS NULL OR  users_requests.user_id<>2)  ) 
#AND (users_requests.is_reject=0 OR users_requests.is_reject IS NULL ) 
#AND (users_requests.is_request=0 OR users_requests.is_request IS NULL )
#AND (users_requests.is_follow=0 OR users_requests.is_follow IS NULL )  
GROUP BY users.id  ORDER by users.id desc limit  0, 10